local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local Lighting = game:GetService("Lighting")
local VirtualUser = game:GetService("VirtualUser")

local player = Players.LocalPlayer
local mouse = player:GetMouse()

local flying = false
local flyVelocity, flyGyro, flyConnection = nil, nil, nil
local speedMult = 1
local jumpMult = 1
local fullBright = false
local nightMode = false
local autoClicking = false
local infiniteJump = false
local noClip = false
local autoHeal = false
local infiniteStamina = false
local antiAfk = false

local originalAmbient = Lighting.Ambient
local originalBrightness = Lighting.Brightness

local function startFly()
    if flying then return end
    local char = player.Character
    if not char then return end
    local hrp = char:FindFirstChild("HumanoidRootPart")
    if not hrp then return end
    flying = true
    local hum = char:FindFirstChildOfClass("Humanoid")
    if hum then hum.PlatformStand = true end

    flyVelocity = Instance.new("BodyVelocity")
    flyVelocity.MaxForce = Vector3.new(1e9,1e9,1e9)
    flyVelocity.Velocity = Vector3.zero
    flyVelocity.P = 9e4
    flyVelocity.Parent = hrp

    flyGyro = Instance.new("BodyGyro")
    flyGyro.MaxTorque = Vector3.new(1e9,1e9,1e9)
    flyGyro.CFrame = hrp.CFrame
    flyGyro.P = 9e4
    flyGyro.Parent = hrp

    flyConnection = RunService.RenderStepped:Connect(function()
        if not flying or not hrp then return end
        local cam = workspace.CurrentCamera
        flyGyro.CFrame = cam.CFrame
        local dir = Vector3.zero
        if UserInputService:IsKeyDown(Enum.KeyCode.W) then dir += cam.CFrame.LookVector end
        if UserInputService:IsKeyDown(Enum.KeyCode.S) then dir -= cam.CFrame.LookVector end
        if UserInputService:IsKeyDown(Enum.KeyCode.A) then dir -= cam.CFrame.RightVector end
        if UserInputService:IsKeyDown(Enum.KeyCode.D) then dir += cam.CFrame.RightVector end
        if UserInputService:IsKeyDown(Enum.KeyCode.Space) then dir += Vector3.new(0,1,0) end
        if UserInputService:IsKeyDown(Enum.KeyCode.LeftControl) then dir -= Vector3.new(0,1,0) end
        local speed = 80
        flyVelocity.Velocity = (dir.Magnitude > 0) and dir.Unit*speed or Vector3.zero
    end)
end

local function stopFly()
    if not flying then return end
    flying = false
    if flyConnection then flyConnection:Disconnect() flyConnection = nil end
    if flyVelocity then flyVelocity:Destroy() flyVelocity = nil end
    if flyGyro then flyGyro:Destroy() flyGyro = nil end
    local char = player.Character
    if char then
        local hum = char:FindFirstChildOfClass("Humanoid")
        if hum then hum.PlatformStand = false end
    end
end

local function updateSpeedJump()
    local hum = player.Character and player.Character:FindFirstChildOfClass("Humanoid")
    if hum then
        hum.WalkSpeed = 16*speedMult
        hum.JumpPower = 50*jumpMult
    end
end

local function setFullBright(on)
    fullBright = on
    if on then
        Lighting.Ambient = Color3.new(1,1,1)
        Lighting.Brightness = 2
    else
        if not nightMode then
            Lighting.Ambient = originalAmbient
            Lighting.Brightness = originalBrightness
        end
    end
end

local function setNightMode(on)
    nightMode = on
    if on then
        Lighting.Ambient = Color3.new(0,0,0)
        Lighting.Brightness = 0.1
    else
        if not fullBright then
            Lighting.Ambient = originalAmbient
            Lighting.Brightness = originalBrightness
        end
    end
end

local autoClickCoroutine = nil
local function startAutoClick()
    if autoClickCoroutine then return end
    autoClickCoroutine = coroutine.create(function()
        while autoClicking do
            local tool = player.Character and player.Character:FindFirstChildOfClass("Tool")
            if tool then tool:Activate() end
            task.wait(0.1)
        end
        autoClickCoroutine = nil
    end)
    coroutine.resume(autoClickCoroutine)
end

local function stopAutoClick()
    autoClicking = false
    autoClickCoroutine = nil
end

UserInputService.JumpRequest:Connect(function()
    if infiniteJump then
        local hum = player.Character and player.Character:FindFirstChildOfClass("Humanoid")
        if hum then hum:ChangeState(Enum.HumanoidStateType.Jumping) end
    end
end)

RunService.Stepped:Connect(function()
    local char = player.Character
    if char then
        for _, part in pairs(char:GetChildren()) do
            if part:IsA("BasePart") and part.Name~="HumanoidRootPart" then
                part.CanCollide = not noClip
            end
        end
    end
end)

RunService.Heartbeat:Connect(function()
    if autoHeal then
        local hum = player.Character and player.Character:FindFirstChildOfClass("Humanoid")
        if hum and hum.Health<hum.MaxHealth then
            hum.Health = math.min(hum.Health+1,hum.MaxHealth)
        end
    end
end)

RunService.Heartbeat:Connect(function()
    if infiniteStamina then
        local hum = player.Character and player.Character:FindFirstChildOfClass("Humanoid")
        if hum and hum:FindFirstChild("Stamina") then
            hum.Stamina.Value = hum.Stamina.MaxValue
        end
    end
end)

player.Idled:Connect(function()
    if antiAfk then
        VirtualUser:CaptureController()
        VirtualUser:ClickButton2(Vector2.new())
    end
end)

local gui = Instance.new("ScreenGui")
gui.Name = "CoolKidHub"
gui.ResetOnSpawn = false
gui.Parent = player:WaitForChild("PlayerGui")

local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0,400,0,350)
mainFrame.Position = UDim2.new(0.5,-200,0.5,-175)
mainFrame.BackgroundColor3 = Color3.fromRGB(255,0,0)
mainFrame.Active = true
mainFrame.Draggable = true
mainFrame.Parent = gui

local function createUICorner(parent,radius)
    local c=Instance.new("UICorner")
    c.CornerRadius=UDim.new(0,radius)
    c.Parent=parent
end
createUICorner(mainFrame,12)

local header=Instance.new("Frame")
header.Size=UDim2.new(1,0,0,40)
header.BackgroundColor3=Color3.fromRGB(0,0,0)
header.Parent=mainFrame
createUICorner(header,12)

local title=Instance.new("TextLabel")
title.Size=UDim2.new(1,0,1,0)
title.BackgroundTransparency=1
title.Text="CoolKid Hub"
title.TextColor3=Color3.fromRGB(255,0,0)
title.Font=Enum.Font.Arcade
title.TextSize=24
title.Parent=header

local closeBtn=Instance.new("TextButton")
closeBtn.Size=UDim2.new(0,35,0,35)
closeBtn.Position=UDim2.new(1,-40,0,2)
closeBtn.BackgroundColor3=Color3.fromRGB(255,0,0)
closeBtn.Text="X"
closeBtn.Font=Enum.Font.Arcade
closeBtn.TextSize=20
closeBtn.TextColor3=Color3.fromRGB(255,255,255)
closeBtn.Parent=header
createUICorner(closeBtn,8)
closeBtn.MouseButton1Click:Connect(function() gui:Destroy() end)

local tabsFrame=Instance.new("Frame")
tabsFrame.Size=UDim2.new(1,0,0,30)
tabsFrame.Position=UDim2.new(0,0,0,45)
tabsFrame.BackgroundTransparency=1
tabsFrame.Parent=mainFrame

local tabContents={}

local contentFrame=Instance.new("Frame")
contentFrame.Size=UDim2.new(1,-20,1,-80)
contentFrame.Position=UDim2.new(0,10,0,80)
contentFrame.BackgroundTransparency=1
contentFrame.Parent=mainFrame

local function selectTab(name)
    for t,f in pairs(tabContents) do f.Visible=(t==name) end
end

local function createTab(name,order)
    local btn=Instance.new("TextButton")
    btn.Size=UDim2.new(0,100,1,0)
    btn.Position=UDim2.new(0,(order-1)*110,0,0)
    btn.BackgroundColor3=Color3.fromRGB(0,0,0)
    btn.Text=name
    btn.Font=Enum.Font.Arcade
    btn.TextSize=20
    btn.TextColor3=Color3.new(1,1,1)
    btn.Parent=tabsFrame
    createUICorner(btn,6)

    local frame=Instance.new("Frame")
    frame.Size=UDim2.new(1,0,1,0)
    frame.BackgroundTransparency=1
    frame.Visible=false
    frame.Parent=contentFrame
    tabContents[name]=frame

    btn.MouseButton1Click:Connect(function() selectTab(name) end)
end

createTab("Main",1)
createTab("Player",2)
createTab("Utility",3)
createTab("Credits",4)

local function createToggle(parent,text,state,posY,callback)
    local btn=Instance.new("TextButton")
    btn.Size=UDim2.new(0,180,0,30)
    btn.Position=UDim2.new(0,10,0,posY)
    btn.BackgroundColor3=state and Color3.fromRGB(0,255,0) or Color3.fromRGB(255,0,0)
    btn.Text=text..": "..(state and "ON" or "OFF")
    btn.Font=Enum.Font.Arcade
    btn.TextColor3=Color3.new(1,1,1)
    btn.Parent=parent
    btn.MouseButton1Click:Connect(function()
        state=not state
        callback(state)
        btn.BackgroundColor3=state and Color3.fromRGB(0,255,0) or Color3.fromRGB(255,0,0)
        btn.Text=text..": "..(state and "ON" or "OFF")
    end)
end

local mainTab=tabContents["Main"]
createToggle(mainTab,"Fly",flying,10,function(v) if v then startFly() else stopFly() end end)

local playerTab=tabContents["Player"]
createToggle(playerTab,"Infinite Jump",infiniteJump,10,function(v) infiniteJump=v end)
createToggle(playerTab,"NoClip",noClip,50,function(v) noClip=v end)
createToggle(playerTab,"Auto Heal",autoHeal,90,function(v) autoHeal=v end)
createToggle(playerTab,"Infinite Stamina",infiniteStamina,130,function(v) infiniteStamina=v end)

local utilTab=tabContents["Utility"]
createToggle(utilTab,"FullBright",fullBright,10,setFullBright)
createToggle(utilTab,"Night Mode",nightMode,50,setNightMode)
createToggle(utilTab,"AutoClick",autoClicking,90,function(v) autoClicking=v if v then startAutoClick() else stopAutoClick() end end)
createToggle(utilTab,"Anti AFK",antiAfk,130,function(v) antiAfk=v end)

local credTab=tabContents["Credits"]
local credits=Instance.new("TextLabel")
credits.Size=UDim2.new(1,0,0,50)
credits.Text="Probug1vr - Youtube"
credits.TextColor3=Color3.new(1,1,1)
credits.Font=Enum.Font.Arcade
credits.TextSize=24
credits.BackgroundTransparency=1
credits.Parent=credTab

selectTab("Main")
print("cool kid gui")
